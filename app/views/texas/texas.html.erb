<%= javascript_include_tag 'texas' %>
<!-- 自分以外のプレイヤーを表示 -->
<div class="other_players_container">
<% i = @table.players.index(@my) %>
<% psize = @table.players.size %>
<% (psize-1).times do %>
  <% i = (i + 1) % psize %>
  <% user = @table.players[i] %>
  <div class="other_players" data-user_id="<%= user.user_id %>">
    <span class="turn">
      <%= "●" if user == @table.turn_user %>
    </span>
    <%= user.name %>
    <%= "(BTN)" if user == @table.btn %>
    <%= "(SB)" if user == @table.sb %>
    <%= "(BB)" if user == @table.bb %>
    <br>
    <div class="card_ura"></div>
    <div class="card_ura"></div>
    <div class="tip">keep: $<%= user.keep_tip %></div>
    <div class="tip">bet: $<%= user.bet_tip %></div>
  </div>
<% end %>
</div>

<!-- テーブルを表示 -->
<div class="game_table">
  <% @table.upcards.each do |card| %>
  <% case card[-1] %>
  <% when "s" %>
  <div class="card_black"><%= card[0,2].to_i %><br>&spades;</div>
  <% when "c" %>
  <div class="card_black"><%= card[0,2].to_i %><br>&clubs;</div>
  <% when "h" %>
  <div class="card_red"><%= card[0,2].to_i %><br>&hearts;</div>
  <% when "d" %>
  <div class="card_red"><%= card[0,2].to_i %><br>&diams;</div>
  <% end %>
  <% end %>
  <% (5 - @table.upcards.size).times do %>
  <div class="card_ura">　<br>　</div>
  <% end %>
</div>

<!-- 自分のプレイヤーを表示 -->
<div class="my_player" data-user_id="<%= @my.user_id %>">
  <span class="turn">
    <%= "●" if @my == @table.turn_user %>
  </span>
  <%= @my.name %>
  <%= "(BTN)" if @my == @table.btn %>
  <%= "(SB)" if @my == @table.sb %>
  <%= "(BB)" if @my == @table.bb %>
  <br>
  <% @my.hand.each do |card| %>
    <% case card[2] %>
    <% when "s" %>
    <div class="card_black"><%= card[0,2].to_i %><br>&spades;</div>
    <% when "c" %>
    <div class="card_black"><%= card[0,2].to_i %><br>&clubs;</div>
    <% when "h" %>
    <div class="card_red"><%= card[0,2].to_i %><br>&hearts;</div>
    <% when "d" %>
    <div class="card_red"><%= card[0,2].to_i %><br>&diams;</div>
    <% end %>
  <% end %>
  <div class="tip">keep: $<%= @my.keep_tip %></div>
  <div class="tip">bet: $<%= @my.bet_tip %></div>
  <% if @my == @table.turn_user then %>
  <div class="buttons">
  <% else %>
  <div class="buttons" hidden>
  <% end %>
  <button id="call">call</button>
  <button id="fold">fold</button>
  <button id="check" hidden>check</button>
  <button id="bet" hidden>bet</button>
  <button id="raise">raise</button>
  <input type="number" id="num" min=0>
  </div>
</div>


<br>
<br>
<br>
<br>
<br>
<p>以下、デバッグ用</p>
login_users:<br>
<%= @login_users %><br>
<br>
cards:<br>
<%= @table.cards %><br>
<br>
@my:<br>
<%= @my.inspect %><br>
<br>
table:<br>
<%= @table.inspect %><br>
<br>
btn: <%= @table.btn.name %><br>
sb: <%= @table.sb.name %><br>
bb: <%= @table.bb.name %><br>
turn_user: <%= @table.turn_user.name %><br>
